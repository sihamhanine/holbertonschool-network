#!/usr/bin/env bash
# Script that configures an Ubuntu server with the following requirements:
# - localhost resolves to 127.0.0.2
# - facebook.com resolves to 8.8.8.8

# Vérifier si le script est exécuté en tant que root
if [ "$(id -u)" -ne 0 ]; then
    echo "This script must be run as root. Use sudo." >&2
    exit 1
fi

# Créer une copie du fichier /etc/hosts
cp /etc/hosts "$HOME/hosts.new"

# Modifier le fichier pour que localhost résolve à 127.0.0.2
sed -i 's/127.0.0.1/127.0.0.2/' "$HOME/hosts.new"

# Ajouter l'entrée pour facebook.com qui résout à 8.8.8.8
sed -i '2i8.8.8.8 facebook.com' "$HOME/hosts.new"

# Copier le fichier modifié dans /etc/hosts
cp -f "$HOME/hosts.new" /etc/hosts

# Suppression du fichier temporaire
rm -f "$HOME/hosts.new"

echo "Configuration completed."
